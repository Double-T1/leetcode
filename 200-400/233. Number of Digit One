var countDigitOne = function(n) {
    let num = n
    let val = 0
    let m = 0
    let total = 0
    let memo = []
    while (num) {
        let digit = num%10
        total += h(digit,m,val,memo)
        val = digit*(10**m) + val
        m++
        num = Math.floor((num/10))
    }
    return total
};

let h = (digit,m,val,memo) => {
    if (m === 0) {
        return digit>=1? 1: 0
    } else {
        let accu = digit*g(m-1,memo)
        if (digit===1) {
            accu += val+1
        } else if (digit>1) {
            accu += 10**m
        }
        return accu
    }
}

let g = (m,memo) => {
    if (m in memo) return memo[m]
    if (m === 0) {
        return 1
    } else {
        memo[m] = g(m-1,memo)*10 + 10**m
        return memo[m]
    }
}



console.log(countDigitOne(1011))
